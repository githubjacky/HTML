\documentclass[12pt,a4paper]{article}

\usepackage[a4paper,text={16.5cm,25.2cm},centering]{geometry}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\DeclareMathOperator{\E}{\mathbb{E}}
\DeclareMathOperator{\Prob}{\mathbb{P}}

\usepackage{bbm}
\usepackage{bm}
\usepackage{graphicx}
\usepackage{microtype}
\usepackage{hyperref}
\setlength{\parindent}{0pt}
\setlength{\parskip}{1.2ex}

\hypersetup
       {   pdfauthor = { Hsiu Hsuan Yeh },
           pdftitle={ HW1 for Machine Learning },
           colorlinks=TRUE,
           linkcolor=black,
           citecolor=blue,
           urlcolor=blue
       }

\title{ HW1 for Machine Learning }

\author{ Hsiu Hsuan Yeh }

\date{ 30th March 2023 }

\usepackage{upquote}
\usepackage{listings}
\usepackage{xcolor}
\lstset{
    basicstyle=\ttfamily\footnotesize,
    upquote=true,
    breaklines=true,
    breakindent=0pt,
    keepspaces=true,
    showspaces=false,
    columns=fullflexible,
    showtabs=false,
    showstringspaces=false,
    escapeinside={(*@}{@*)},
    extendedchars=true,
}
\newcommand{\HLJLt}[1]{#1}
\newcommand{\HLJLw}[1]{#1}
\newcommand{\HLJLe}[1]{#1}
\newcommand{\HLJLeB}[1]{#1}
\newcommand{\HLJLo}[1]{#1}
\newcommand{\HLJLk}[1]{\textcolor[RGB]{148,91,176}{\textbf{#1}}}
\newcommand{\HLJLkc}[1]{\textcolor[RGB]{59,151,46}{\textit{#1}}}
\newcommand{\HLJLkd}[1]{\textcolor[RGB]{214,102,97}{\textit{#1}}}
\newcommand{\HLJLkn}[1]{\textcolor[RGB]{148,91,176}{\textbf{#1}}}
\newcommand{\HLJLkp}[1]{\textcolor[RGB]{148,91,176}{\textbf{#1}}}
\newcommand{\HLJLkr}[1]{\textcolor[RGB]{148,91,176}{\textbf{#1}}}
\newcommand{\HLJLkt}[1]{\textcolor[RGB]{148,91,176}{\textbf{#1}}}
\newcommand{\HLJLn}[1]{#1}
\newcommand{\HLJLna}[1]{#1}
\newcommand{\HLJLnb}[1]{#1}
\newcommand{\HLJLnbp}[1]{#1}
\newcommand{\HLJLnc}[1]{#1}
\newcommand{\HLJLncB}[1]{#1}
\newcommand{\HLJLnd}[1]{\textcolor[RGB]{214,102,97}{#1}}
\newcommand{\HLJLne}[1]{#1}
\newcommand{\HLJLneB}[1]{#1}
\newcommand{\HLJLnf}[1]{\textcolor[RGB]{66,102,213}{#1}}
\newcommand{\HLJLnfm}[1]{\textcolor[RGB]{66,102,213}{#1}}
\newcommand{\HLJLnp}[1]{#1}
\newcommand{\HLJLnl}[1]{#1}
\newcommand{\HLJLnn}[1]{#1}
\newcommand{\HLJLno}[1]{#1}
\newcommand{\HLJLnt}[1]{#1}
\newcommand{\HLJLnv}[1]{#1}
\newcommand{\HLJLnvc}[1]{#1}
\newcommand{\HLJLnvg}[1]{#1}
\newcommand{\HLJLnvi}[1]{#1}
\newcommand{\HLJLnvm}[1]{#1}
\newcommand{\HLJLl}[1]{#1}
\newcommand{\HLJLld}[1]{\textcolor[RGB]{148,91,176}{\textit{#1}}}
\newcommand{\HLJLs}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsa}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsb}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsc}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsd}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsdB}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsdC}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLse}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLsh}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsi}[1]{#1}
\newcommand{\HLJLso}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsr}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLss}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLssB}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLnB}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLnbB}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLnfB}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLnh}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLni}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLnil}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLnoB}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLoB}[1]{\textcolor[RGB]{102,102,102}{\textbf{#1}}}
\newcommand{\HLJLow}[1]{\textcolor[RGB]{102,102,102}{\textbf{#1}}}
\newcommand{\HLJLp}[1]{#1}
\newcommand{\HLJLc}[1]{\textcolor[RGB]{153,153,119}{\textit{#1}}}
\newcommand{\HLJLch}[1]{\textcolor[RGB]{153,153,119}{\textit{#1}}}
\newcommand{\HLJLcm}[1]{\textcolor[RGB]{153,153,119}{\textit{#1}}}
\newcommand{\HLJLcp}[1]{\textcolor[RGB]{153,153,119}{\textit{#1}}}
\newcommand{\HLJLcpB}[1]{\textcolor[RGB]{153,153,119}{\textit{#1}}}
\newcommand{\HLJLcs}[1]{\textcolor[RGB]{153,153,119}{\textit{#1}}}
\newcommand{\HLJLcsB}[1]{\textcolor[RGB]{153,153,119}{\textit{#1}}}
\newcommand{\HLJLg}[1]{#1}
\newcommand{\HLJLgd}[1]{#1}
\newcommand{\HLJLge}[1]{#1}
\newcommand{\HLJLgeB}[1]{#1}
\newcommand{\HLJLgh}[1]{#1}
\newcommand{\HLJLgi}[1]{#1}
\newcommand{\HLJLgo}[1]{#1}
\newcommand{\HLJLgp}[1]{#1}
\newcommand{\HLJLgs}[1]{#1}
\newcommand{\HLJLgsB}[1]{#1}
\newcommand{\HLJLgt}[1]{#1}


\begin{document}

\maketitle

\section{Multiple Choice}
\subsection{(a)}
Since the machine learning is a kind of data-driven algorithm and both (b) and (c) don't need to collect the data. They are not suitable. In terms of (d), it's a bit  tricky in that we can't find the "actual" look of Zeus, so we can't collect the  data and do the machine learning. For (a) we can collect the data and let the  machine learn the relations between requests and responses, reacting through the  learned relations. 

\subsection{(d)}
\[
y_{n(t)}w_t^Tx_n \le 0
\]
\[
y_{n(t)}w_{t+1}^Tx_n > 0
\]
let's denote the learning rate to be $\eta$

\[
y_{n(t)} w_{t+1}^T x_{n(t)} = 
    y_{n(t)} (w_t + y_{n(t)} x_{n(t)} \eta)^T x_{n(t)} = 
    y_{n(t)} w_t^T x_{n(t)} + y_{n(t)}^2 x_{n(t)}^T x_{n(t)} \eta > 0
\]
\[
\Rightarrow 
    \eta > \frac{-y_{n(t)} w_t^T x_{n(t)}}{y_{n(t)}^2 x_{n(t)}^T x_{n(t)}} = 
    \frac{-y_{n(t)} w_t^T x_{n(t)}}{\lVert {x_{n(t)}} \rVert^2}
\]
\[
\Rightarrow 
    \eta = \left \lfloor 
        {\frac{-y_{n(t)} w_t^T x_{n(t)}}{\lVert {x_{n(t)}} \rVert ^ 2} + 1} 
    \right \rfloor
\]
\subsection{(c)}
\[
w_{t+1} \leftarrow w_t + y_{n(t)} z_{n(t)},
z_{n(t)} = \frac{x_{n(t)}}{\lVert {x_{n(t)}} \rVert}
\]
\[
w_f' = \frac{w_f}{\lVert w_f \rVert}, 
\lVert w_f' \rVert = 1
\]
\[
\rho_z = 
    \min_{n} \frac{y_nw_f^Tz_n}{\lVert w_f \rVert} = 
    \min_{n} y_nw_f'^Tz_n
\]
\[
w_f'^Tw_{t+1} \ge 
    w_f'^Tw_t + \rho_z, 
\Rightarrow w_f'^Tw_T \ge w_f'^Tw_0 + T\rho_z
\]
\[
\lVert w_{t+1}^2 \rVert \le 
    \lVert w_t \rVert^2 + \lVert z_n \rVert^2 = 
    \lVert w_t \rVert^2 + 1, 
\Rightarrow \lVert w_T \rVert^2 \le \lVert w_0 \rVert^2 + T
\]
\[
\frac{w_f'^Tw_0 + T\rho_z}{\lVert w_f' \rVert \sqrt{\lVert w_0 \rVert^2 + T}} \le 
    \frac{w_f'^Tw_T}{\lVert w_f' \rVert \lVert w_T \rVert} = 
    cos\theta \le 1
\]
assume $w_0=0$

\[
\sqrt{T}\rho_z \le 1, 
\Rightarrow T \le \frac{1}{\rho_z^2}
\]
\subsection{(b)}
\[
U = 
    \frac{1}{\rho_z^2} = 
    \frac{1}{(\min_{n} y_n w_f'^T z_n)^2} = 
    \frac{1}{(\min_{n} y_n w_f'^T \frac{x_n}{\Vert {x_n} \rVert})^2}
\]
\[
U_{orig} = 
    \frac{\max_{n} \lVert {x_n} \rVert^2}{(\min_{n} y_nw_f'^T x_n)^2}
\]
because $U_{orig}$ maximize the numerator and minimize the denominator simultaneously, 

\[
\Rightarrow U \le U_{orig}
\]
\subsection{(c)}
\begin{itemize}
\item PLA:

\end{itemize}
\[
w_1=0+[-1, 2, -2] = [-1, 2, -2]
\]
\[
w_2=[-1, 2, -2]+[1, 1, 1] = [0, 3, -1]
\]
wrongly predicted: $(x, y) = ([1, \frac{1}{2}, 2], 1), ([1, \frac{1}{4}, 1], 1)$

\begin{itemize}
\item PAM

\end{itemize}
\[
w_1=0+[-1, 2, -2] = [-1, 2, -2]
\]
\[
w_2=[-1, 2, -2]+[1, 2, 0] = [0, 4, -2]
\]
\[
w_3=[0, 4, -2]+[-1, 1, 0] = [-1, 5, -2]
\]
\[
w_3=[-1, 5, -2]+[1, 1, 1] = [0, 6, -1]
\]
all the test samples are correctly predicted

The number of test samples are wrongly predicted by PLA but correctly predicted  by PAM is 2

$\pagebreak$

\subsection{(a)}
The ratings of movies is the label and the label is given so it's surpervised  learning. Moreover, ratings are within [1, 5] which is continuous so it's a  regression task.

\subsection{(d)}
Human labeler'goal is to compare and decide which one is better. The main purpose of this step is to train the model to have general understanding of the text. Further tuning will be conduct in the down-stream task. Best assoicated learning problem is the self-surperivsed learning.

\subsection{(c)}
In this case, there are two kinds of label +1, -1. If we plot the data, we can  observe that it's linare separable. Therefore, the minimum out sample error is 0. However, if all the data's label in the training set are same kind either +1, -1, there might be the case that the out sample error is 1 in that the algorithm  fail to identity.

\subsection{(d)}
The distribution of data is unifomly within [+1, -1]*[+1, -1]. The sample space  is a square with side length 2. Therefore, each data point's probability ensity is $\frac{1}{4}$

On one hand, the out sample error for hopothesis $h_1$ occurs when the samples  lie in the area within the unit circle but outside the circel with radius 0.5.

\[
E_{out}(h_1) = \frac{\pi 1^2 - \pi 0.25^2}{2*2} = \frac{3 \pi}{16}
\]
On the other hand, the out sample error for hopothesis $h_2$ occurs when the samples lie in the area within the circlue with radius 0.5 but outside the rhombus with side length $\sqrt{0.5}$

\[
E_{out}(h_2) = \frac{\pi 0.25 ^2 - 4 * \frac{1}{2}*0.5*0.5}{2*2} = \frac{\pi - 2}{16}
\]
\subsection{(b)}
Following the previous problem, samples that make the in sample error equal to 0 for both hypothesis lie in the area within the rhombus or between the unit circle and the square. Since we sample 4 times the probabiltiy should be the probability  of one sample to the power of 4.

\[
(\frac{(4*\frac{1}{2}*0.5*0.5)+(4-\pi1^2)}{4})^4 = (\frac{\frac{9}{2}-\pi}{4})^4 \approx 0.0133
\]
$\pagebreak$

\subsection{(d)}
First denote the random variable $X_i = \mathbbm{1}$(the darts in the circle)

\[
\Prob(X_i = 1) = \frac{\pi}{4},
\E(\frac{\Sigma_{i=1}^n X_i}{N}) = \frac{\pi}{4}
\]
\[
\Prob(|\frac{\Sigma_{i=1}^n X_i}{N} - \frac{\pi}{4}| \le \frac{10^{-2}}{4}) > 0.99
\]
\[
\Prob(|\frac{\Sigma_{i=1}^n X_i}{N} - \frac{\pi}{4}| < \frac{10^{-2}}{4}) \le 0.99
\]
\[
2\exp{(-2(\frac{10^{-2}}{4})^2N)} = 0.01, 
\Rightarrow
    N = \frac{-8}{10^{-4}}\log{\frac{0.01}{2}} \approx 423866
\]
\subsection{(d)}
\[
\Prob(b_m \text{ is } \epsilon \text{-optimal}) = \Prob(
    (|\frac{c_1}{N} - p_1| \le \frac{\epsilon}{2}) \cap
     (|\frac{c_2}{N} - p_2| \le \frac{\epsilon}{2}) \cap ... \cap
      (|\frac{c_M}{N} - p_M| \le \frac{\epsilon}{2})
)
\]
\[
 = 1 - \Prob(
    (|\frac{c_1}{N} - p_1| > \frac{\epsilon}{2}) \cup
    (|\frac{c_2}{N} - p_2| > \frac{\epsilon}{2}) \cup ... \cup
    (|\frac{c_M}{N} - p_M| > \frac{\epsilon}{2})
)
\]
\[
> 1 - 2M\exp{\frac{-\epsilon^2 N}{2}}
\]
\[
\Rightarrow 
    \delta = 2M\exp{\frac{-\epsilon^2 N}{2}}, 
N = \frac{2}{\epsilon^2}\ln{\frac{2M}{\delta}}
\]
$\pagebreak$

\section{Coding}


\subsection{(b)}

\begin{lstlisting}
(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{,}@*) (*@\HLJLn{N}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{read{\_}data}@*)(*@\HLJLp{()}@*)
(*@\HLJLn{avg{\_}error}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{mean}@*)(*@\HLJLp{([}@*)(*@\HLJLnf{PLA}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{,}@*) (*@\HLJLn{M}@*)(*@\HLJLoB{=}@*)(*@\HLJLn{N}@*)(*@\HLJLoB{/}@*)(*@\HLJLni{2}@*)(*@\HLJLp{,}@*) (*@\HLJLn{seed}@*)(*@\HLJLoB{=}@*)(*@\HLJLn{i}@*)(*@\HLJLp{)[}@*)(*@\HLJLni{3}@*)(*@\HLJLp{]}@*) (*@\HLJLk{for}@*) (*@\HLJLn{i}@*) (*@\HLJLoB{=}@*)(*@\HLJLni{1}@*)(*@\HLJLoB{:}@*)(*@\HLJLni{1000}@*)(*@\HLJLp{])}@*)
(*@\HLJLnf{print}@*)(*@\HLJLp{(}@*)(*@\HLJLs{"{}average}@*) (*@\HLJLs{of}@*) (*@\HLJLs{the}@*) (*@\HLJLs{in}@*) (*@\HLJLs{sample}@*) (*@\HLJLs{error:}@*) (*@\HLJLsi{{\$}avg{\_}error}@*)(*@\HLJLs{"{}}@*)(*@\HLJLp{)}@*)
\end{lstlisting}

\begin{lstlisting}
average of the in sample error: 0.02003515625
\end{lstlisting}


\subsection{(a)}

\begin{lstlisting}
(*@\HLJLn{avg{\_}error}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{mean}@*)(*@\HLJLp{([}@*)(*@\HLJLnf{PLA}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{,}@*) (*@\HLJLn{M}@*)(*@\HLJLoB{=}@*)(*@\HLJLni{4}@*)(*@\HLJLn{N}@*)(*@\HLJLp{,}@*) (*@\HLJLn{seed}@*)(*@\HLJLoB{=}@*)(*@\HLJLn{i}@*)(*@\HLJLp{)[}@*)(*@\HLJLni{3}@*)(*@\HLJLp{]}@*) (*@\HLJLk{for}@*) (*@\HLJLn{i}@*) (*@\HLJLoB{=}@*)(*@\HLJLni{1}@*)(*@\HLJLoB{:}@*)(*@\HLJLni{1000}@*)(*@\HLJLp{])}@*)
(*@\HLJLnf{print}@*)(*@\HLJLp{(}@*)(*@\HLJLs{"{}average}@*) (*@\HLJLs{of}@*) (*@\HLJLs{the}@*) (*@\HLJLs{in}@*) (*@\HLJLs{sample}@*) (*@\HLJLs{error:}@*) (*@\HLJLsi{{\$}avg{\_}error}@*)(*@\HLJLs{"{}}@*)(*@\HLJLp{)}@*)
\end{lstlisting}

\begin{lstlisting}
average of the in sample error: 0.0001875
\end{lstlisting}


\subsection{(d)}

\begin{lstlisting}
(*@\HLJLn{med{\_}iter}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{median}@*)(*@\HLJLp{([}@*)(*@\HLJLnf{PLA}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{,}@*) (*@\HLJLn{M}@*)(*@\HLJLoB{=}@*)(*@\HLJLni{4}@*)(*@\HLJLn{N}@*)(*@\HLJLp{,}@*) (*@\HLJLn{seed}@*)(*@\HLJLoB{=}@*)(*@\HLJLn{i}@*)(*@\HLJLp{)[}@*)(*@\HLJLni{2}@*)(*@\HLJLp{]}@*) (*@\HLJLk{for}@*) (*@\HLJLn{i}@*) (*@\HLJLoB{=}@*)(*@\HLJLni{1}@*)(*@\HLJLoB{:}@*)(*@\HLJLni{1000}@*)(*@\HLJLp{])}@*)
(*@\HLJLnf{print}@*)(*@\HLJLp{(}@*)(*@\HLJLs{"{}median}@*) (*@\HLJLs{of}@*) (*@\HLJLs{the}@*) (*@\HLJLs{iterations:}@*) (*@\HLJLsi{{\$}med{\_}iter}@*)(*@\HLJLs{"{}}@*)(*@\HLJLp{)}@*)
\end{lstlisting}

\begin{lstlisting}
median of the iterations: 453.0
\end{lstlisting}


\subsection{(e)}

\begin{lstlisting}
(*@\HLJLn{med{\_}w\ensuremath{\_0}}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{median}@*)(*@\HLJLp{([}@*)(*@\HLJLnf{PLA}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{,}@*) (*@\HLJLn{M}@*)(*@\HLJLoB{=}@*)(*@\HLJLni{4}@*)(*@\HLJLn{N}@*)(*@\HLJLp{,}@*) (*@\HLJLn{seed}@*)(*@\HLJLoB{=}@*)(*@\HLJLn{i}@*)(*@\HLJLp{)[}@*)(*@\HLJLni{1}@*)(*@\HLJLp{][}@*)(*@\HLJLni{1}@*)(*@\HLJLp{]}@*) (*@\HLJLk{for}@*) (*@\HLJLn{i}@*) (*@\HLJLoB{=}@*)(*@\HLJLni{1}@*)(*@\HLJLoB{:}@*)(*@\HLJLni{1000}@*)(*@\HLJLp{])}@*)
(*@\HLJLnf{print}@*)(*@\HLJLp{(}@*)(*@\HLJLs{"{}median}@*) (*@\HLJLs{of}@*) (*@\HLJLs{the}@*) (*@\HLJLs{w\ensuremath{\_0}:}@*) (*@\HLJLsi{{\$}med{\_}w\ensuremath{\_0}}@*)(*@\HLJLs{"{}}@*)(*@\HLJLp{)}@*)
\end{lstlisting}

\begin{lstlisting}
median of the w(*@\ensuremath{\_0}@*): 35.0
\end{lstlisting}


\subsection{(d)}

\begin{lstlisting}
(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{,}@*) (*@\HLJLn{N}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{read{\_}data}@*)(*@\HLJLp{(}@*)(*@\HLJLn{scale}@*)(*@\HLJLoB{=}@*)(*@\HLJLni{2}@*)(*@\HLJLp{)}@*)
(*@\HLJLn{med{\_}iter}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{median}@*)(*@\HLJLp{([}@*)(*@\HLJLnf{PLA}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{,}@*) (*@\HLJLn{M}@*)(*@\HLJLoB{=}@*)(*@\HLJLni{4}@*)(*@\HLJLn{N}@*)(*@\HLJLp{,}@*) (*@\HLJLn{seed}@*)(*@\HLJLoB{=}@*)(*@\HLJLn{i}@*)(*@\HLJLp{)[}@*)(*@\HLJLni{2}@*)(*@\HLJLp{]}@*) (*@\HLJLk{for}@*) (*@\HLJLn{i}@*) (*@\HLJLoB{=}@*)(*@\HLJLni{1}@*)(*@\HLJLoB{:}@*)(*@\HLJLni{1000}@*)(*@\HLJLp{])}@*)
(*@\HLJLnf{print}@*)(*@\HLJLp{(}@*)(*@\HLJLs{"{}median}@*) (*@\HLJLs{of}@*) (*@\HLJLs{the}@*) (*@\HLJLs{iterations:}@*) (*@\HLJLsi{{\$}med{\_}iter}@*)(*@\HLJLs{"{}}@*)(*@\HLJLp{)}@*)
\end{lstlisting}

\begin{lstlisting}
median of the iterations: 453.0
\end{lstlisting}


\subsection{(d)}

\begin{lstlisting}
(*@\HLJLn{x\ensuremath{\_0}}@*) (*@\HLJLoB{=}@*) (*@\HLJLni{0}@*)
(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{,}@*) (*@\HLJLn{N}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{read{\_}data}@*)(*@\HLJLp{(}@*)(*@\HLJLn{x\ensuremath{\_0}}@*)(*@\HLJLoB{=}@*)(*@\HLJLn{x\ensuremath{\_0}}@*)(*@\HLJLp{)}@*)
(*@\HLJLn{med{\_}iter}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{median}@*)(*@\HLJLp{([}@*)(*@\HLJLnf{PLA}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{,}@*) (*@\HLJLn{M}@*)(*@\HLJLoB{=}@*)(*@\HLJLni{4}@*)(*@\HLJLn{N}@*)(*@\HLJLp{,}@*) (*@\HLJLn{seed}@*)(*@\HLJLoB{=}@*)(*@\HLJLn{i}@*)(*@\HLJLp{)[}@*)(*@\HLJLni{2}@*)(*@\HLJLp{]}@*) (*@\HLJLk{for}@*) (*@\HLJLn{i}@*) (*@\HLJLoB{=}@*)(*@\HLJLni{1}@*)(*@\HLJLoB{:}@*)(*@\HLJLni{1000}@*)(*@\HLJLp{])}@*)
(*@\HLJLnf{print}@*)(*@\HLJLp{(}@*)(*@\HLJLs{"{}median}@*) (*@\HLJLs{of}@*) (*@\HLJLs{the}@*) (*@\HLJLs{iterations:}@*) (*@\HLJLsi{{\$}med{\_}iter}@*)(*@\HLJLs{"{}}@*)(*@\HLJLp{)}@*)
\end{lstlisting}

\begin{lstlisting}
median of the iterations: 445.5
\end{lstlisting}


\subsection{(e)}

\begin{lstlisting}
(*@\HLJLn{x\ensuremath{\_0}}@*) (*@\HLJLoB{=}@*) (*@\HLJLoB{-}@*)(*@\HLJLni{1}@*)
(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{,}@*) (*@\HLJLn{N}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{read{\_}data}@*)(*@\HLJLp{(}@*)(*@\HLJLn{x\ensuremath{\_0}}@*)(*@\HLJLoB{=}@*)(*@\HLJLn{x\ensuremath{\_0}}@*)(*@\HLJLp{)}@*)
(*@\HLJLn{med{\_}w\ensuremath{\_0}x\ensuremath{\_0}}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{median}@*)(*@\HLJLp{([}@*)(*@\HLJLn{x\ensuremath{\_0}}@*)(*@\HLJLoB{*}@*)(*@\HLJLp{(}@*)(*@\HLJLnf{PLA}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{,}@*) (*@\HLJLn{M}@*)(*@\HLJLoB{=}@*)(*@\HLJLni{4}@*)(*@\HLJLn{N}@*)(*@\HLJLp{,}@*) (*@\HLJLn{seed}@*)(*@\HLJLoB{=}@*)(*@\HLJLn{i}@*)(*@\HLJLp{)[}@*)(*@\HLJLni{1}@*)(*@\HLJLp{][}@*)(*@\HLJLni{1}@*)(*@\HLJLp{])}@*) (*@\HLJLk{for}@*) (*@\HLJLn{i}@*) (*@\HLJLoB{=}@*)(*@\HLJLni{1}@*)(*@\HLJLoB{:}@*)(*@\HLJLni{1000}@*)(*@\HLJLp{])}@*)

(*@\HLJLnf{print}@*)(*@\HLJLp{(}@*)(*@\HLJLs{"{}median}@*) (*@\HLJLs{of}@*) (*@\HLJLs{the}@*) (*@\HLJLs{w\ensuremath{\_0}x\ensuremath{\_0}:}@*) (*@\HLJLsi{{\$}}@*)(*@\HLJLp{(}@*)(*@\HLJLn{med{\_}w\ensuremath{\_0}x\ensuremath{\_0}}@*)(*@\HLJLp{)}@*)(*@\HLJLs{"{}}@*)(*@\HLJLp{)}@*)
\end{lstlisting}

\begin{lstlisting}
median of the w(*@\ensuremath{\_0}@*)x(*@\ensuremath{\_0}@*): 35.0
\end{lstlisting}


\subsection{(c)}

\begin{lstlisting}
(*@\HLJLn{x\ensuremath{\_0}}@*) (*@\HLJLoB{=}@*) (*@\HLJLnfB{0.1126}@*)
(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{,}@*) (*@\HLJLn{N}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{read{\_}data}@*)(*@\HLJLp{(}@*)(*@\HLJLn{x\ensuremath{\_0}}@*)(*@\HLJLoB{=}@*)(*@\HLJLn{x\ensuremath{\_0}}@*)(*@\HLJLp{)}@*)
(*@\HLJLn{med{\_}w\ensuremath{\_0}x\ensuremath{\_0}}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{median}@*)(*@\HLJLp{([}@*)(*@\HLJLn{x\ensuremath{\_0}}@*)(*@\HLJLoB{*}@*)(*@\HLJLp{(}@*)(*@\HLJLnf{PLA}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{,}@*) (*@\HLJLn{M}@*)(*@\HLJLoB{=}@*)(*@\HLJLni{4}@*)(*@\HLJLn{N}@*)(*@\HLJLp{,}@*) (*@\HLJLn{seed}@*)(*@\HLJLoB{=}@*)(*@\HLJLn{i}@*)(*@\HLJLp{)[}@*)(*@\HLJLni{1}@*)(*@\HLJLp{][}@*)(*@\HLJLni{1}@*)(*@\HLJLp{])}@*) (*@\HLJLk{for}@*) (*@\HLJLn{i}@*) (*@\HLJLoB{=}@*)(*@\HLJLni{1}@*)(*@\HLJLoB{:}@*)(*@\HLJLni{1000}@*)(*@\HLJLp{])}@*)

(*@\HLJLnf{print}@*)(*@\HLJLp{(}@*)(*@\HLJLs{"{}median}@*) (*@\HLJLs{of}@*) (*@\HLJLs{the}@*) (*@\HLJLs{w\ensuremath{\_0}x\ensuremath{\_0}:}@*) (*@\HLJLsi{{\$}}@*)(*@\HLJLp{(}@*)(*@\HLJLn{med{\_}w\ensuremath{\_0}x\ensuremath{\_0}}@*)(*@\HLJLp{)}@*)(*@\HLJLs{"{}}@*)(*@\HLJLp{)}@*)
\end{lstlisting}

\begin{lstlisting}
median of the w(*@\ensuremath{\_0}@*)x(*@\ensuremath{\_0}@*): 0.4310778400000001
\end{lstlisting}


$\pagebreak$

\section{Code Reference}

\begin{lstlisting}
(*@\HLJLk{import}@*) (*@\HLJLn{DelimitedFiles}@*)(*@\HLJLoB{:}@*) (*@\HLJLn{readdlm}@*)
(*@\HLJLk{import}@*) (*@\HLJLn{Random}@*)(*@\HLJLoB{:}@*) (*@\HLJLn{seed!}@*)
(*@\HLJLk{import}@*) (*@\HLJLn{Distributions}@*)(*@\HLJLoB{:}@*) (*@\HLJLn{sample}@*)
(*@\HLJLk{import}@*) (*@\HLJLn{Statistics}@*)(*@\HLJLoB{:}@*) (*@\HLJLn{median}@*)(*@\HLJLp{,}@*) (*@\HLJLn{mean}@*)
(*@\HLJLk{import}@*) (*@\HLJLn{LinearAlgebra}@*)(*@\HLJLoB{:}@*) (*@\HLJLn{normalize}@*)

(*@\HLJLnf{normalize{\_}row}@*)(*@\HLJLp{(}@*)(*@\HLJLn{a}@*)(*@\HLJLp{)}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{vcat}@*)(*@\HLJLp{([}@*)(*@\HLJLnf{transpose}@*)(*@\HLJLp{(}@*)(*@\HLJLnf{normalize}@*)(*@\HLJLp{(}@*)(*@\HLJLn{i}@*)(*@\HLJLp{,}@*) (*@\HLJLni{2}@*)(*@\HLJLp{))}@*) (*@\HLJLk{for}@*) (*@\HLJLn{i}@*)(*@\HLJLoB{=}@*)(*@\HLJLnf{eachrow}@*)(*@\HLJLp{(}@*)(*@\HLJLn{a}@*)(*@\HLJLp{)]}@*)(*@\HLJLoB{...}@*)(*@\HLJLp{)}@*)

(*@\HLJLk{function}@*) (*@\HLJLnf{read{\_}data}@*)(*@\HLJLp{(}@*)(*@\HLJLn{path}@*)(*@\HLJLoB{=}@*)(*@\HLJLs{"{}../hw1{\_}train.txt"{}}@*)(*@\HLJLp{;}@*) (*@\HLJLn{x\ensuremath{\_0}}@*)(*@\HLJLoB{=}@*)(*@\HLJLni{1}@*)(*@\HLJLp{,}@*) (*@\HLJLn{scale}@*)(*@\HLJLoB{=}@*)(*@\HLJLnfB{1.}@*)(*@\HLJLp{,}@*) (*@\HLJLn{normalize}@*)(*@\HLJLoB{=}@*)(*@\HLJLkc{false}@*)(*@\HLJLp{)}@*)
    (*@\HLJLn{data}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{readdlm}@*)(*@\HLJLp{(}@*)(*@\HLJLn{path}@*)(*@\HLJLp{,}@*) (*@\HLJLsc{{\textquotesingle}{\textbackslash}t{\textquotesingle}}@*)(*@\HLJLp{,}@*) (*@\HLJLn{Float64}@*)(*@\HLJLp{,}@*) (*@\HLJLsc{{\textquotesingle}{\textbackslash}n{\textquotesingle}}@*)(*@\HLJLp{)}@*)
    (*@\HLJLn{features}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{hcat}@*)(*@\HLJLp{(}@*)(*@\HLJLn{x\ensuremath{\_0}}@*)(*@\HLJLoB{*}@*)(*@\HLJLnf{ones}@*)(*@\HLJLp{(}@*)(*@\HLJLnf{size}@*)(*@\HLJLp{(}@*)(*@\HLJLn{data}@*)(*@\HLJLp{,}@*) (*@\HLJLni{1}@*)(*@\HLJLp{)),}@*) (*@\HLJLn{data}@*)(*@\HLJLp{[}@*)(*@\HLJLoB{:}@*)(*@\HLJLp{,}@*) (*@\HLJLk{begin}@*)(*@\HLJLoB{:}@*)(*@\HLJLk{end}@*)(*@\HLJLoB{-}@*)(*@\HLJLni{1}@*)(*@\HLJLp{])}@*) (*@\HLJLoB{./}@*) (*@\HLJLn{scale}@*)
    (*@\HLJLn{normalize}@*) (*@\HLJLoB{{\&}{\&}}@*) (*@\HLJLp{(}@*)(*@\HLJLn{features}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{normalize{\_}row}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLp{))}@*)
    (*@\HLJLn{label}@*) (*@\HLJLoB{=}@*) (*@\HLJLn{data}@*)(*@\HLJLp{[}@*)(*@\HLJLoB{:}@*)(*@\HLJLp{,}@*) (*@\HLJLk{end}@*)(*@\HLJLp{]}@*)
    
    (*@\HLJLk{return}@*) (*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{,}@*) (*@\HLJLnf{size}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLni{1}@*)(*@\HLJLp{)}@*)
(*@\HLJLk{end}@*)

(*@\HLJLnf{check{\_}sign}@*)(*@\HLJLp{(}@*)(*@\HLJLn{a}@*)(*@\HLJLp{)}@*) (*@\HLJLoB{=}@*) (*@\HLJLn{a}@*) (*@\HLJLoB{==}@*) (*@\HLJLnfB{0.}@*) (*@\HLJLoB{?}@*) (*@\HLJLp{(}@*)(*@\HLJLk{return}@*) (*@\HLJLnfB{1.}@*)(*@\HLJLp{)}@*) (*@\HLJLoB{:}@*) (*@\HLJLp{(}@*)(*@\HLJLk{return}@*) (*@\HLJLnf{sign}@*)(*@\HLJLp{(}@*)(*@\HLJLn{a}@*)(*@\HLJLp{))}@*)

(*@\HLJLnf{finderror}@*)(*@\HLJLp{(}@*)(*@\HLJLn{s}@*)(*@\HLJLoB{::}@*)(*@\HLJLn{Symbol}@*)(*@\HLJLp{,}@*) (*@\HLJLn{args}@*)(*@\HLJLoB{...}@*)(*@\HLJLp{)}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{finderror}@*)(*@\HLJLp{(}@*)(*@\HLJLnf{Val}@*)(*@\HLJLp{{\{}}@*)(*@\HLJLn{s}@*)(*@\HLJLp{{\}}(),}@*) (*@\HLJLn{args}@*)(*@\HLJLoB{...}@*)(*@\HLJLp{)}@*)
(*@\HLJLnf{finderror}@*)(*@\HLJLp{(}@*)(*@\HLJLoB{::}@*)(*@\HLJLnf{Val}@*)(*@\HLJLp{{\{}}@*)(*@\HLJLsc{:single}@*)(*@\HLJLp{{\}},}@*) (*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{w}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{)}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{findfirst}@*)(*@\HLJLp{(}@*)
    (*@\HLJLn{x}@*)(*@\HLJLoB{->}@*)(*@\HLJLn{x!}@*)(*@\HLJLoB{=}@*)(*@\HLJLnfB{0.}@*)(*@\HLJLp{,}@*) 
    (*@\HLJLn{check{\_}sign}@*)(*@\HLJLoB{.}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLoB{*}@*)(*@\HLJLn{w}@*)(*@\HLJLp{)}@*) (*@\HLJLoB{.-}@*) (*@\HLJLn{label}@*)
(*@\HLJLp{)}@*)
(*@\HLJLnf{finderror}@*)(*@\HLJLp{(}@*)(*@\HLJLoB{::}@*)(*@\HLJLnf{Val}@*)(*@\HLJLp{{\{}}@*)(*@\HLJLsc{:multiple}@*)(*@\HLJLp{{\}},}@*) (*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{w}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{)}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{findall}@*)(*@\HLJLp{(}@*)
    (*@\HLJLn{x}@*)(*@\HLJLoB{->}@*)(*@\HLJLn{x!}@*)(*@\HLJLoB{=}@*)(*@\HLJLnfB{0.}@*)(*@\HLJLp{,}@*) 
    (*@\HLJLn{check{\_}sign}@*)(*@\HLJLoB{.}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLoB{*}@*)(*@\HLJLn{w}@*)(*@\HLJLp{)}@*) (*@\HLJLoB{.-}@*) (*@\HLJLn{label}@*)
(*@\HLJLp{)}@*)

(*@\HLJLk{function}@*) (*@\HLJLnf{PLA}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{;}@*) (*@\HLJLn{M}@*)(*@\HLJLp{,}@*) (*@\HLJLn{seed}@*)(*@\HLJLoB{=}@*)(*@\HLJLni{20230525}@*)(*@\HLJLp{)}@*)
    (*@\HLJLnf{seed!}@*)(*@\HLJLp{(}@*)(*@\HLJLn{seed}@*)(*@\HLJLp{)}@*)
    (*@\HLJLn{obs}@*)(*@\HLJLp{,}@*) (*@\HLJLn{w}@*)(*@\HLJLp{,}@*) (*@\HLJLn{iter}@*)(*@\HLJLp{,}@*) (*@\HLJLn{m}@*)(*@\HLJLp{,}@*) (*@\HLJLn{M}@*) (*@\HLJLoB{=}@*) (*@\HLJLni{1}@*)(*@\HLJLoB{:}@*)(*@\HLJLnf{size}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLni{1}@*)(*@\HLJLp{),}@*) 
                         (*@\HLJLnf{zeros}@*)(*@\HLJLp{(}@*)(*@\HLJLnf{size}@*)(*@\HLJLp{(}@*)(*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLni{2}@*)(*@\HLJLp{)),}@*) 
                         (*@\HLJLni{0}@*)(*@\HLJLp{,}@*) 
                         (*@\HLJLni{0}@*)(*@\HLJLp{,}@*)
                         (*@\HLJLnf{ceil}@*)(*@\HLJLp{(}@*)(*@\HLJLn{Int}@*)(*@\HLJLp{,}@*) (*@\HLJLn{M}@*)(*@\HLJLp{)}@*)
    (*@\HLJLk{while}@*) (*@\HLJLoB{!}@*)(*@\HLJLnf{isnothing}@*)(*@\HLJLp{(}@*)(*@\HLJLn{m}@*)(*@\HLJLp{)}@*)
        (*@\HLJLn{idx}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{rand}@*)(*@\HLJLp{(}@*)(*@\HLJLnf{finderror}@*)(*@\HLJLp{(}@*)(*@\HLJLsc{:multiple}@*)(*@\HLJLp{,}@*) (*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{w}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{))}@*)
        (*@\HLJLn{w}@*) (*@\HLJLoB{+=}@*) (*@\HLJLn{label}@*)(*@\HLJLp{[}@*)(*@\HLJLn{idx}@*)(*@\HLJLp{]}@*)(*@\HLJLoB{*}@*)(*@\HLJLn{features}@*)(*@\HLJLp{[}@*)(*@\HLJLn{idx}@*)(*@\HLJLp{,}@*) (*@\HLJLoB{:}@*)(*@\HLJLp{]}@*)
        (*@\HLJLn{iter}@*) (*@\HLJLoB{+=}@*) (*@\HLJLni{1}@*)

        (*@\HLJLn{idxes}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{sample}@*)(*@\HLJLp{(}@*)(*@\HLJLn{obs}@*)(*@\HLJLp{,}@*) (*@\HLJLn{M}@*)(*@\HLJLp{;}@*) (*@\HLJLn{replace}@*)(*@\HLJLoB{=}@*)(*@\HLJLkc{true}@*)(*@\HLJLp{)}@*)
        (*@\HLJLn{m}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{finderror}@*)(*@\HLJLp{(}@*)(*@\HLJLsc{:single}@*)(*@\HLJLp{,}@*) (*@\HLJLn{features}@*)(*@\HLJLp{[}@*)(*@\HLJLn{idxes}@*)(*@\HLJLp{,}@*) (*@\HLJLoB{:}@*)(*@\HLJLp{],}@*) (*@\HLJLn{w}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{[}@*)(*@\HLJLn{idxes}@*)(*@\HLJLp{])}@*)
    (*@\HLJLk{end}@*)
    (*@\HLJLn{error}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{length}@*)(*@\HLJLp{(}@*)(*@\HLJLnf{finderror}@*)(*@\HLJLp{(}@*)(*@\HLJLsc{:multiple}@*)(*@\HLJLp{,}@*) (*@\HLJLn{features}@*)(*@\HLJLp{,}@*) (*@\HLJLn{w}@*)(*@\HLJLp{,}@*) (*@\HLJLn{label}@*)(*@\HLJLp{))}@*) (*@\HLJLoB{/}@*) (*@\HLJLnf{length}@*)(*@\HLJLp{(}@*)(*@\HLJLn{obs}@*)(*@\HLJLp{)}@*)

    (*@\HLJLk{return}@*) (*@\HLJLn{w}@*)(*@\HLJLp{,}@*) (*@\HLJLn{iter}@*)(*@\HLJLp{,}@*) (*@\HLJLn{error}@*)
(*@\HLJLk{end}@*)
\end{lstlisting}


\end{document}